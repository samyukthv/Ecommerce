<!doctype html>
<html lang="zxx">

<head>
  <!-- Required meta tags -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <title>aranaz</title>
  <link rel="icon" href="/assetuser/img/favicon.png">
  <!-- Bootstrap CSS -->
  <link rel="stylesheet" href="/assetuser/css/bootstrap.min.css">
  <!-- animate CSS -->
  <link rel="stylesheet" href="/assetuser/css/animate.css">
  <!-- owl carousel CSS -->
  <link rel="stylesheet" href="/assetuser/css/owl.carousel.min.css">
  <!-- nice select CSS -->
  <link rel="stylesheet" href="/assetuser/css/nice-select.css">
  <!-- font awesome CSS -->
  <link rel="stylesheet" href="/assetuser/css/all.css">
  <!-- flaticon CSS -->
  <link rel="stylesheet" href="/assetuser/css/flaticon.css">
  <link rel="stylesheet" href="/assetuser/css/themify-icons.css">
  <!-- font awesome CSS -->
  <link rel="stylesheet" href="/assetuser/css/magnific-popup.css">
  <!-- swiper CSS -->
  <link rel="stylesheet" href="/assetuser/css/slick.css">
  <link rel="stylesheet" href="/assetuser/css/price_rangs.css">
  <!-- style CSS -->
  <link rel="stylesheet" href="/assetuser/css/style.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.3.0/css/all.min.css">


</head>

<body>
  {{>userHeader}}


  <!--================Home Banner Area =================-->
  <!-- breadcrumb start-->
  <section class="breadcrumb breadcrumb_bg" style="height: 350px;">
    <div class="container">
      <div class="row justify-content-center">
        <div class="col-lg-8">
          <div class="breadcrumb_iner">
            <div class="breadcrumb_iner_item">
              <h2>Cart Products</h2>
              <p><a href="/" style="text-decoration: none;">Home</a> <span>-</span>Cart Products</p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>
  <!-- breadcrumb start-->

  <!--================Cart Area =================-->

  {{#if fill}}

  <div class="card-body cart" style="  background-color: #ECFDFF; height: 500px;">
    <div class="col-sm-12 empty-cart-cls text-center">
      <img src="https://i.imgur.com/dCdflKN.png" width="130" height="150" class="img-fluid mb-4 mr-3">
      <h3><strong>Your Cart is Empty</strong></h3>
      <h4>Add something to make me happy :)</h4>
      <a href="/products" class="btn_3 m-3" data-abc="true">continue shopping</a>


    </div>
  </div>



  {{else}}
  <section class="cart_area padding_top" style="padding-top: 70px">
    <div class="container">
      <div class="cart_inner">
        <div class="table-responsive">
          <table class="table" id="table">
            <thead>
              <tr>
                <th scope="col">Product</th>

                <th scope="col">Price</th>
                <th scope="col">Quantity</th>
                <th scope="col">Total</th>
                <th></th>
              </tr>
            </thead>


            <tbody>
              {{#each cartfind.cart}}
              <tr>

                <td>
                  <div class="media">
                    <div class="d-flex">
                      <div style="position: relative;">
                        <img style="width: 15%;" src="/images/{{this.productid.image.[0]}}" alt="" />
                      </div>
                      <div style="margin-right: 30%;" class="media-body">
                        <p>{{this.productid.productName}}</p>
                      </div>
                    </div>

                  </div>
                </td>
                <td>
                  <h5>&#8377;{{this.productid.price}}</h5>
                </td>
                <td>
                  <div class="product_count " style="display: flex;align-items: center;">
                    <div style="margin-right: 10%; width: 50px;">
                      <button id="" style="margin-bottom: 20%; border: none; width: 30px;"
                        onclick="changeQty('{{this.productid._id}}','{{this.productid.price}}',+1)">
                        <i class="ti-angle-up"></i>
                      </button>
                      <button id="" style="margin-top:20%; border: none; width: 30px;"
                        onclick="changeQty('{{this.productid._id}}','{{this.productid.price}}',-1)">
                        <i class="ti-angle-down"></i>
                      </button>
                    </div>

                    <div>

                      <span id="{{this.productid._id}}">{{this.quantity}}</span>
                    </div>



                  </div>
                </td>
                <td>
                  <span class="{{this.productid._id}}">&#8377;{{this.total}}</span>
                </td>
                <td><a onclick="deleteCart('{{this.productid._id}}')" class=""
                    style="margin-right: 1%;margin-top: 5%; font-size: 25px;"><i
                      class="fa-regular fa-circle-xmark"></i></a></td>
              </tr>

              {{/each}}
              <tr class="bottom_button">

              </tr>
              <tr>
                <td></td>
                <td></td>
                <td>
                  <h5>Subtotal</h5>
                </td>
                <td>
                  <span id="subTotal">&#8377;{{totalcart}}</span>
                </td>
              </tr>

            </tbody>
          </table>
          <div class="checkout_btn_inner  d-flex float-right ml-5   col-md-12">
            <div style="margin-right: 3%;">
              <a class="btn_3 col-md-12 col-12 text-center" href="/products">back to Shopping</a>
            </div>
            <div style="margin-left: auto;">
              <a class="btn_3  col-md-12  col-12  text-center" href="/checkOut"> checkout</a>
            </div>
          </div>
        </div>
      </div>
  </section>
  {{/if}}


  <style>
    @import url(http://fonts.googleapis.com/css?family=Calibri:400,300,700);

    body {}

    .mt-100 {
      margin-top: 100px;

    }


    .card {
      margin-bottom: 30px;
      border: 0;
      -webkit-transition: all .3s ease;
      transition: all .3s ease;
      letter-spacing: .5px;
      border-radius: 8px;
      -webkit-box-shadow: 1px 5px 24px 0 rgba(68, 102, 242, .05);
      box-shadow: 1px 5px 24px 0 rgba(68, 102, 242, .05);
    }

    .card .card-header {
      background-color: #fff;
      border-bottom: none;
      padding: 24px;
      border-bottom: 1px solid #f6f7fb;
      border-top-left-radius: 8px;
      border-top-right-radius: 8px;
    }

    .card-header:first-child {
      border-radius: calc(.25rem - 1px) calc(.25rem - 1px) 0 0;
    }



    .card .card-body {
      padding: 30px;
      background-color: transparent;
    }

    .btn-primary,
    .btn-primary.disabled,
    .btn-primary:disabled {
      background-color: #4466f2 !important;
      border-color: #4466f2 !important;
    }
  </style>

  <script>
    function deleteCart(proId) {
      $.ajax({
        url: '/deleteCart/' + proId,
        method: 'get',
        success: (response) => {
          Swal.fire({
            position: 'top-end',
            title: 'Product removed from cart',
            showConfirmButton: false,
            timer: 1500
          })
          $('#table').load('/cart #table')
        }
      })
    }
  </script>


  <script>

    function changeQty(productid, price, count) {
      let quantity = parseInt(document.getElementById(productid).innerHTML)
      count = parseInt(count)
      if (quantity <= 1 && count == -1) {

      } else {
        $.ajax({
          url: '/changeqty',
          data: {
            product: productid,
            count: count,
            price: price,

          },
          method: 'post',
          success: (response) => {


            document.getElementById(productid).innerHTML = parseInt(quantity) + count
            document.getElementsByClassName(productid)[0].innerHTML = response.proPrice
            document.getElementById('subTotal').innerHTML = response.cartTotal

          }
        })
      }

    }
  </script>




  {{>userFooter}}